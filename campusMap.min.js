addScript("http://s7.addthis.com/js/300/addthis_widget.js#pubid=xa-51f6872a25a1fb8c",{win:window,doc:document});var campusMap=new CampusMap(options),map=new Map(options);function addScript(a,b){var e=b.doc.createElement("script");e.type="text/javascript";e.src=a;b.doc.getElementsByTagName("body")[0].appendChild(e)} function CampusMap(a){this.element=a.element?a.element:console.log("No element provided.");this.menuState=a.menuState?a.menuState:1;this.includeMenus=null==a.includeMenus?!0:a.includeMenus;this.objectFile="Prebuilt/maps/data/newCatObj.txt";this.device=0;this.categories=[];this.globals={doc:document,win:window};addScript("http://maps.googleapis.com/maps/api/js?v=3&sensor=false&callback=campusMap.initializeMaps",this.globals)} CampusMap.prototype.initializeMaps=function(){this.buildHTML();map.initiateMap(this.globals);this.detectDevice();this.includeMenus&&(this.loadCatObjs(),this.bindMenuButton());google.maps.event.addListenerOnce(map.map,"tilesloaded",function(){!0===map.embedOptions.embed?map.createEmbedMarker():campusMap.anchorLocation();campusMap.setMapHeight();campusMap.includeMenus&&(campusMap.buildMapKey(),campusMap.initializeSearch())})}; CampusMap.prototype.buildHTML=function(){var a=this.includeMenus?'<div id="title"><h1 id="heading">BYU-Idaho Campus Map</h1><a id="device_type" href="#" onmousedown="toggleDevice(); return false;" title="Switch Device Type"><div id="device_container"><div class="device icon-desktop"></div><div class="device icon-mobile"></div></div></a><a id="menu_button" class="icon-settings" href="#" title="Open Menu. Click this or press [space] bar"></a></div>':"",a=a+'<div id="container" name="container">'+(this.includeMenus? '<div id="menu" name="menu" style="display:block; z-index: 2;"><div id="inner_menu" class="scrolling-element-class" ><div id="object_search"><input type="text" placeholder="Search"/><span class="icon-cancel"></span></div><nav id="categories" class="child-element"></nav>\x3c!-- // categories --\x3e</div>\x3c!-- // inner menu --\x3e</div>\x3c!-- // menu --\x3e':""),a=a+'<div id="map_canvas"><div id="nojs-msg"><br/>This BYU-Idaho Campus Map application requires Javascript to run. <br/>Your device or browser doesn\'t appear to have JavaScript enabled. <br/>Please enable it and try again, or try another device or browser.</div></div>', a=a+'<div id="map_keys"></div>';this.globals.doc.getElementById(this.element).innerHTML=a};CampusMap.prototype.loadCatObjs=function(a){var b=this.objectFile,e=this,d;d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");d.onreadystatechange=function(){if(4==d.readyState){var b=JSON.parse(d.responseText);e.parseCategories(b);a&&"function"===typeof a&&a()}};d.open("GET",b,!0);d.send()}; CampusMap.prototype.parseCategories=function(a){for(var b=0,e=a.length;b<e;b++){var d=a[b];this.categories.push(new Category(d.ID,d.name,d.title,d.text,d.icon,d.type,d.link,this.globals,"cat_"+b));this.categories[b].markerLocations=d.objects?this.parseLocations(d.objects,d.icon):null;this.categories[b].polygonLocations=d.polygons?this.parseAreas(d.polygons):null;this.globals.doc.getElementById("categories").appendChild(this.categories[b].getCatDOMObj())}this.bindAllEvents()}; CampusMap.prototype.parseLocations=function(a,b){for(var e=[],d=0,c=a.length;d<c;d++){var f=a[d];e.push(new Location(f.name,f.code,f.lat,f.lon,f.img,f.hours,f.info,f.link,d,this.globals,b))}return e};CampusMap.prototype.parseAreas=function(a){for(var b=[],e=0,d=a.length;e<d;e++){var c=a[e];b.push(new Area(c.name,c.code,c.contains,c.borderColor,c.fillColor,c.map,this.globals))}return b};CampusMap.prototype.detectDevice=function(){this.device=800>this.globals.doc.body.offsetWidth?0:1}; CampusMap.prototype.bindAllEvents=function(){for(var a,b=0,e=this.categories.length;b<e;b++){a=this.categories[b];a.bindEventListener();if(a.markerLocations)for(var d=0,c=a.markerLocations.length;d<c;d++)a.markerLocations[d].bindEventListener();if(a.polygonLocations)for(d=0,c=a.polygonLocations.length;d<c;d++)a.polygonLocations[d].bindEventListener()}}; CampusMap.prototype.buildMapKey=function(){for(var a="",b=0,e=this.categories.length;b<e;b++)a+=this.categories[b].buildMapKey();this.globals.doc.getElementById("map_keys").innerHTML=a};CampusMap.prototype.getMapHeight=function(){var a=this.globals.doc.getElementById(this.element).offsetHeight;return this.includeMenus?a-57:a}; CampusMap.prototype.setMapHeight=function(){var a=this.getMapHeight();this.globals.doc.getElementById("container").style.height=a+"px";this.globals.doc.getElementById("map_canvas").style.height=a+"px"};CampusMap.prototype.initializeSearch=function(){var a=this.globals.doc.getElementById("object_search").children[0];a.addEventListener("keyup",function(){campusMap.performSearch(this.value)});a.nextSibling.addEventListener("click",function(){a.value="";campusMap.performSearch("")})}; CampusMap.prototype.performSearch=function(a){if(""!=a){a=a.toLowerCase();for(var b=0,e=this.categories.length;b<e;b++){var d=this.categories[b],c=(d.markerLocations?d.markerLocations.length:0)+(d.polygonLocations?d.polygonLocations.length:0);if(d.markerLocations)for(var f=0,g=d.markerLocations.length;f<g;f++)-1===d.markerLocations[f].name.toLowerCase().indexOf(a)?(d.markerLocations[f].hideAll(),c--):d.markerLocations[f].showAll();if(d.polygonLocations)for(f=0,g=d.polygonLocations.length;f<g;f++)-1=== d.polygonLocations[f].name.toLowerCase().indexOf(a)?(d.polygonLocations[f].hideAll(),c--):d.polygonLocations[f].showAll();f=this.globals.doc.getElementById(d.elementID).parentElement.children[1];0<c?d.openCategory(f):d.closeCategory(f)}}else for(b=0,e=this.categories.length;b<e;b++)d=this.categories[b],d.markerLocations&&this.categories[b].hideAllMarkers(),d.polygonLocations&&this.categories[b].hideAllPolygons(),f=this.globals.doc.getElementById(d.elementID).parentElement.children[1],d.closeCategory(f)}; CampusMap.prototype.bindMenuButton=function(){this.globals.doc.getElementById("menu_button").addEventListener("click",function(){campusMap.toggleMenu()})};CampusMap.prototype.toggleMenu=function(){this.menuState?this.hideMenu():this.showMenu()};CampusMap.prototype.hideMenu=function(){this.menuState=0;this.globals.doc.getElementById("menu").style.display="none"};CampusMap.prototype.showMenu=function(){this.menuState=1;this.globals.doc.getElementById("menu").style.display="block"}; CampusMap.prototype.anchorLocation=function(){if(window.location.hash){var a=window.location.hash.substr(1),a=this.findObject(a);a.showAll();this.fireEvent(this.globals.doc.getElementById(a.elementID),"click")}}; CampusMap.prototype.findObject=function(a){for(var b=null,e=0,d=this.categories.length;e<d&&null===b;e++){var c=this.categories[e];if(c.markerLocations)for(var f=0,g=c.markerLocations.length;f<g&&null===b;f++)c.markerLocations[f].code===a&&(b=c.markerLocations[f]);if(c.polygonLocations)for(f=0,g=c.polygonLocations.length;f<g&&null===b;f++)c.markerLocations[f].code===a&&(b=c.polygonLocations[f])}return b}; CampusMap.prototype.fireEvent=function(a,b){if(document.createEvent){var e=document.createEvent("HTMLEvents");e.initEvent(b,!0,!0);return!a.dispatchEvent(e)}e=document.createEventObject();return a.fireEvent("on"+b,e)}; function Map(a){this.map;this.mapOptions={campusOverlayVisible:null==a.campusOverlay?!0:a.campusOverlay,campusFile:"http://www.byui.edu/Prebuilt/maps/campus_outline.xml",centerCoordinates:[43.815045,-111.783515]};this.embedOptions={embed:a.embed,coordinates:null!==a.centerCoordinates?a.centerCoordinates:[43.815045,-111.783515],name:a.locationName?a.locationName:"",icon:a.icon?a.icon:"blue",zoom:a.zoom?a.zoom:16,mapView:a.mapView?a.mapView:"satellite"};this.googleMapOptions={};this.infoWindow;this.campusLayer} Map.prototype.initiateMap=function(a){this.setGoogleMapOptions();this.setGoogleMap(a);this.setInfoWindow();this.setCampusLayer()}; Map.prototype.setGoogleMapOptions=function(){var a="map"===this.embedOptions.mapView?google.maps.MapTypeId.ROADMAP:google.maps.MapTypeId.HYBRID,b=!0===this.embedOptions.embed?this.embedOptions.coordinates:this.mapOptions.centerCoordinates;this.googleMapOptions={zoom:this.embedOptions.embed?this.embedOptions.zoom:16,center:new google.maps.LatLng(b[0],b[1]),mapTypeId:a,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.HYBRID,google.maps.MapTypeId.TERRAIN]}}}; Map.prototype.setGoogleMap=function(a){this.map=new google.maps.Map(a.doc.getElementById("map_canvas"),this.googleMapOptions)};Map.prototype.setInfoWindow=function(){this.infoWindow=new google.maps.InfoWindow};Map.prototype.setCampusLayer=function(){this.campusLayer=new google.maps.KmlLayer(this.mapOptions.campusFile,{suppressInfoWindows:!0,map:this.map,preserveViewport:!0,zoom:18})}; Map.prototype.createMarker=function(a,b,e,d){return new google.maps.Marker({position:new google.maps.LatLng(a,b),visible:!1,map:this.map,title:e,icon:d})}; Map.prototype.createInfoWindow=function(a,b){var e=this.infoWindow,d=this.map;google.maps.event.addListener(a,"click",function(){var c="",f=b.name,g,h=b.link,k=b.hours,l=b.phone,m=b.address,n=b.info;b.img&&(g=-1===b.img.indexOf(":")?"Prebuilt/maps/imgs/objects/"+b.img:b.img);c=c+'<div class="infopane">'+("<h2>"+f+"</h2>");c+="<div>";g&&(c+='<img src="'+g+'" alt="'+f+'"',c+=' style="float:right;margin:0 0 10px 10px"/>');c+='<div class="button-div">';l&&(c+='<a class="phone-call btn btn-large btn-primary icon-call" href="tel:'+ l+'" ></a>');h&&(c+='<a href="'+h+'" target="_blank" class="btn btn-large btn-primary">More Info</a>');c+="</div>";k&&(c+='<div class="info-row info-hours"><strong>Hours:</strong> '+k+"</div>");l&&(c+='<div class="info-row info-phone"><strong>Phone:</strong> '+l+"</div>");m&&(c+='<div class="info-row info-address"><strong>Address:</strong> '+m+"</div>");n&&(c+='<div class="info-row info-info"><strong>Info:</strong> '+n+"</div>");c+="</div>";c+="</div>";c+='<div class="addthis_toolbox addthis_32x32_style addthis_default_style">'; c+="<p>Share this location.</p>";c+='<a class="addthis_button_facebook social_button"></a>';c+='<a class="addthis_button_google_plusone_share social_button"></a>';c+='<a class="addthis_button_twitter social_button"></a>';c+='<a class="addthis_button_compact social_button"></a>';c+="</div>";e.setContent(c);e.open(d,a);addthis.toolbox(".addthis_toolbox",{},{url:"http://www.byui.edu/maps#"+b.code,title:b.name})})}; Map.prototype.createEmbedMarker=function(){this.createMarker(this.embedOptions.coordinates[0],this.embedOptions.coordinates[1],this.embedOptions.name,"http://www.byui.edu/Prebuilt/maps/imgs/icons/"+this.embedOptions.icon+".png").setVisible(!0)};function Category(a,b,e,d,c,f,g,h,k){this.id=a;this.name=b;this.title=e;this.text=d;this.iconColor=c;this.type=f;this.link=g;this.markerLocations=[];this.polygonLocations=[];this.state=0;this.elementID=k;this.globals=h} Category.prototype.buildCatDOM=function(){var a=this.globals.doc.createElement("a");a.className="category_bar";a.id=this.elementID;a.setAttribute("href","#");a.innerHTML+='<img class="cat_icon" src="Prebuilt/maps/imgs/icons/blank-colors/'+this.iconColor+'.png" />';a.innerHTML+='<span class="category_name">'+this.title+"</span>";return a}; Category.prototype.getCatDOMObj=function(){var a=this.globals.doc.createElement("div");a.className="category";a.appendChild(this.buildCatDOM());var b=this.globals.doc.createElement("div");b.className="cat_container";b.innerHTML='<div class="cat_info"><p>'+this.text+'</p><a href="'+this.link+'" target="_blank">'+this.title+" website</a></div>";var e=this.globals.doc.createElement("div"),e=this.appendLocations(e),e=this.appendAreas(e);b.appendChild(e);a.appendChild(b);return a}; Category.prototype.appendLocations=function(a){if(this.markerLocations)for(var b=0,e=this.markerLocations.length;b<e;b++)a.appendChild(this.markerLocations[b].buildLocationDOM());return a};Category.prototype.appendAreas=function(a){if(this.polygonLocations)for(var b=0,e=this.polygonLocations.length;b<e;b++)a.appendChild(this.polygonLocations[b].buildAreaDOM());return a}; Category.prototype.bindEventListener=function(){var a=this;this.globals.doc.getElementById(this.elementID).addEventListener("click",function(){a.toggle()})};Category.prototype.toggle=function(){var a=this.globals.doc.getElementById(this.elementID).parentElement.children[1];map.infoWindow.close();this.toggleMarkersVisibility();0===this.state?this.openCategory(a):this.closeCategory(a)};Category.prototype.openCategory=function(a){a.style.display="block";a.style.height="100%";this.state=1}; Category.prototype.closeCategory=function(a){a.style.display="none";a.style.height="0";this.state=0};Category.prototype.toggleMarkersVisibility=function(){0===this.state?this.showAllMarkers():this.hideAllMarkers()};Category.prototype.showAllMarkers=function(){if(this.markerLocations)for(var a=0,b=this.markerLocations.length;a<b;a++)this.markerLocations[a].hidden||this.markerLocations[a].marker.setVisible(!0)}; Category.prototype.hideAllMarkers=function(){if(this.markerLocations)for(var a=0,b=this.markerLocations.length;a<b;a++)this.markerLocations[a].showNavigation(),this.markerLocations[a].hideMarker()};Category.prototype.hideAllPolygons=function(){if(this.polygonLocations)for(var a=0,b=this.polygonLocations.length;a<b;a++)this.polygonLocations[a].showNavigation(),this.polygonLocations[a].hideMapKey()}; Category.prototype.buildMapKey=function(){var a="";if(this.polygonLocations){for(var a="<div id='poly_key_"+this.id+"' class='map_key_category map_key_"+this.name+"' style='display: none'><div class='key_title'>"+this.name+" Map Key</div><a class='close icon-cancel nolink' href='#'></a>",b=0,e=this.polygonLocations.length;b<e;b++)a+=this.polygonLocations[b].buildMapKey();a+="</div>"}return a}; function Location(a,b,e,d,c,f,g,h,k,l,m){this.number=k+1;this.name=a;this.code=b;this.lat=e;this.lon=d;this.img=c;this.hours=f;this.info=g;this.link=h;this.color=m;this.elementID=this.code+"_"+this.number;this.marker;this.globals=l;this.hidden=!1;this.createMarker();this.createInfoWindow()} Location.prototype.buildLocationDOM=function(){var a=this.globals.doc.createElement("a");a.className="object marker_object";a.id=this.elementID;a.name=this.name;a.setAttribute("href","#"+this.code);a.innerHTML+='<img class="obj_icon" src="Prebuilt/maps/imgs/icons/numeral-icons/'+this.color+"/"+this.number+'.png" alt="'+name+'" />';a.innerHTML+='<div class="object_name">'+this.name+"</div>";return a}; Location.prototype.bindEventListener=function(){var a=this;this.globals.doc.getElementById(this.elementID).addEventListener("click",function(){a.panToMarker()})};Location.prototype.panToMarker=function(){var a=google.maps.event.addListener(map,"moveend",function(){map.map.fromLatLngToDivPixel(this.marker.getPosition());google.maps.event.removeListener(a)});map.map.panTo(this.marker.getPosition());google.maps.event.trigger(this.marker,"click")}; Location.prototype.createMarker=function(){this.marker=map.createMarker(this.lat,this.lon,this.name,"Prebuilt/maps/imgs/icons/numeral-icons/"+this.color+"/"+this.number+".png")};Location.prototype.createInfoWindow=function(){map.createInfoWindow(this.marker,this)};Location.prototype.hideAll=function(){this.hideNavigation();this.hideMarker()};Location.prototype.hideMarker=function(){this.marker.setVisible(!1)}; Location.prototype.hideNavigation=function(){this.hidden=!0;this.globals.doc.getElementById(this.elementID).style.display="none"};Location.prototype.showAll=function(){this.showMarker();this.showNavigation()};Location.prototype.showMarker=function(){this.marker.setVisible(!0)};Location.prototype.showNavigation=function(){this.hidden=!1;this.globals.doc.getElementById(this.elementID).style.display="block"}; function Area(a,b,e,d,c,f,g){this.name=a;this.code=b;this.contains=e;this.borderColor=d;this.fillColor=c;this.map=f;this.polygon;this.elementID=this.code+"_poly";this.globals=g;this.state=0;this.hidden=!1;this.createPolygon()} Area.prototype.buildAreaDOM=function(){var a=this.globals.doc.createElement("a");a.className="object polygon";a.id=this.elementID;a.setAttribute("href","#"+this.code);a.innerHTML='<div class="polygon_key" id="poly_'+this.name+'" style="border-color:'+this.borderColor+"; background-color:"+this.fillColor+'"><span>&nbsp;</span></div>';a.innerHTML+='<div class="object_name polygon">'+this.name+"</div>";return a}; Area.prototype.buildMapKey=function(){return'<div class="polygon_key" id="poly_key_'+this.code+'" style="border-color:'+this.borderColor+"; background-color:"+this.fillColor+'">'+this.code+"</div>"};Area.prototype.bindEventListener=function(){var a=this;this.globals.doc.getElementById(this.elementID).addEventListener("click",function(){a.togglePolygon()})}; Area.prototype.togglePolygon=function(){var a=this.globals.doc.getElementById(this.elementID).children[0].children[0],b=this.globals.doc.getElementById("poly_key_"+this.code);0===this.state?this.showPolygon(a,b):1===this.state&&this.hidePolygon(a,b)};Area.prototype.showPolygon=function(a,b){this.polygon.setMap(map.map);a.className="icon-checkmark";b.parentElement.style.display="block";b.className="polygon_key active_key";this.state=1}; Area.prototype.hidePolygon=function(a,b){this.polygon.setMap(null);a.className="";b.className="polygon_key";1>this.globals.doc.querySelectorAll("#"+b.parentElement.id+" .active_key").length&&(b.parentElement.style.display="none");this.state=0};Area.prototype.createPolygon=function(){this.polygon=new google.maps.KmlLayer(this.map,{suppressInfoWindows:!1,preserveViewport:!0})};Area.prototype.hideAll=function(){this.hideMapKey();this.hideNavigation()}; Area.prototype.hideMapKey=function(){var a=this.globals.doc.getElementById(this.elementID).children[0].children[0],b=this.globals.doc.getElementById("poly_key_"+this.code);this.hidePolygon(a,b)};Area.prototype.hideNavigation=function(){this.hidden=!0;this.globals.doc.getElementById(this.elementID).style.display="none"};Area.prototype.showAll=function(){this.showMapKey();this.showNavigation()}; Area.prototype.showMapKey=function(){var a=this.globals.doc.getElementById(this.elementID).children[0].children[0],b=this.globals.doc.getElementById("poly_key_"+this.code);this.showPolygon(a,b)};Area.prototype.showNavigation=function(){this.hidden=!1;this.globals.doc.getElementById(this.elementID).style.display="block"};